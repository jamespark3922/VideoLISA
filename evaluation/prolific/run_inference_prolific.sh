SCRIPT="evaluation/prolific/inference_prolific.py"
VERSION="VideoLISA-3.8B"
VID_TOWER="openai/clip-vit-large-patch14-336"
NUM_FRMS_SPARSE=32
NUM_FRMS_DENSE=4
SUBSET_NUM=8
CATEGORY=general # animals, dance, general, pedestrian, sports
VIS_SAVE_PATH="results/VideoLISA-prolific-${CATEGORY}"
set -x

# Step-1: run inference
CUDA_VISIBLE_DEVICES=0 python $SCRIPT \
  --subset_idx=0 \
  --version=$VERSION \
  --vision_tower=$VID_TOWER \
  --vis_save_path=$VIS_SAVE_PATH \
  --num_frames_dense=$NUM_FRMS_DENSE \
  --num_frames_sparse=$NUM_FRMS_SPARSE \
  --meta_exp_path="/weka/oe-training-default/mm-olmo/video_datasets/prolific/video_text_queries_filtered_111025_val_category_${CATEGORY}/annotation/largest_center/" \
  --video_folder="/weka/oe-training-default/mm-olmo/video_datasets/prolific/video_text_queries_filtered_111025_val/JPEGImages/" \
  --subset_num=$SUBSET_NUM
#   --subset_num=$SUBSET_NUM &
# CUDA_VISIBLE_DEVICES=1 python $SCRIPT \
#   --subset_idx=1 \
#   --version=$VERSION \
#   --vision_tower=$VID_TOWER \
#   --vis_save_path=$VIS_SAVE_PATH \
#   --num_frames_dense=$NUM_FRMS_DENSE \
#   --num_frames_sparse=$NUM_FRMS_SPARSE \
#   --subset_num=$SUBSET_NUM &
# CUDA_VISIBLE_DEVICES=2 python $SCRIPT \
#   --subset_idx=2 \
#   --version=$VERSION \
#   --vision_tower=$VID_TOWER \
#   --vis_save_path=$VIS_SAVE_PATH \
#   --num_frames_dense=$NUM_FRMS_DENSE \
#   --num_frames_sparse=$NUM_FRMS_SPARSE \
#   --subset_num=$SUBSET_NUM &
# CUDA_VISIBLE_DEVICES=3 python $SCRIPT \
#   --subset_idx=3 \
#   --version=$VERSION \
#   --vision_tower=$VID_TOWER \
#   --vis_save_path=$VIS_SAVE_PATH \
#   --num_frames_dense=$NUM_FRMS_DENSE \
#   --num_frames_sparse=$NUM_FRMS_SPARSE \
#   --subset_num=$SUBSET_NUM  &
# CUDA_VISIBLE_DEVICES=4 python $SCRIPT \
#   --subset_idx=4 \
#   --version=$VERSION \
#   --vision_tower=$VID_TOWER \
#   --vis_save_path=$VIS_SAVE_PATH \
#   --num_frames_dense=$NUM_FRMS_DENSE \
#   --num_frames_sparse=$NUM_FRMS_SPARSE \
#   --subset_num=$SUBSET_NUM &
# CUDA_VISIBLE_DEVICES=5 python $SCRIPT \
#   --subset_idx=5 \
#   --version=$VERSION \
#   --vision_tower=$VID_TOWER \
#   --vis_save_path=$VIS_SAVE_PATH \
#   --num_frames_dense=$NUM_FRMS_DENSE \
#   --num_frames_sparse=$NUM_FRMS_SPARSE \
#   --subset_num=$SUBSET_NUM &
# CUDA_VISIBLE_DEVICES=6 python $SCRIPT \
#   --subset_idx=6 \
#   --version=$VERSION \
#   --vision_tower=$VID_TOWER \
#   --vis_save_path=$VIS_SAVE_PATH \
#   --num_frames_dense=$NUM_FRMS_DENSE \
#   --num_frames_sparse=$NUM_FRMS_SPARSE \
#   --subset_num=$SUBSET_NUM &
# CUDA_VISIBLE_DEVICES=7 python $SCRIPT \
#   --subset_idx=7 \
#   --version=$VERSION \
#   --vision_tower=$VID_TOWER \
#   --vis_save_path=$VIS_SAVE_PATH \
#   --num_frames_dense=$NUM_FRMS_DENSE \
#   --num_frames_sparse=$NUM_FRMS_SPARSE \
#   --subset_num=$SUBSET_NUM

